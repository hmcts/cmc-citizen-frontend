{% extends "layout.njk" %}
{% from "support.njk" import supportWidget %}
{% from "form.njk" import csrfProtection, submitButton %}

{% set title = t('Money claim') %}
{% set heading = t('Send your response by email') %}

{% macro externalLink(text, href) %}
  <a href="{{ href }}" target="_blank">{{ text }}</a>
  <span class="font-xsmall">{{ t('(opens in a new window)') }}</span>
{% endmacro %}

{% block content %}
  <div class="grid-row">
    <div class="column-two-thirds">
      <div class="panel-indent">
        <div class="panel panel-border-wide">
          <p>{{ t('You must email your response by <span class="bold">{{ responseDeadline }}</span>',
            { responseDeadline: claim.responseDeadline | date }) | safe }}</p>
        </div>
      </div>

      {% if draft.response.type === ResponseType.DEFENCE %}
        {% if draft.rejectAllOfClaim.option === RejectAllOfClaimOption.COUNTER_CLAIM %}

        <h2 class="heading-medium">{{ t('Counterclaim fee') }}</h2>
        <p>
          {{ t('You`ll need to pay a court fee if you make a counterclaim.')}}
        </p>
        <details class="notice">
          <summary>{{ t('View claim fees') }}</summary>

          <div class="panel">
            <p>
              {{ t('The fee is based on the amount you`re claiming, including interest.') }}
            </p>
            <table>
              <thead>
              <tr>
                <th scope="col">{{ t('Claim amount') }}</th>
                <th scope="col">{{ t('Fee') }}</th>
              </tr>
              </thead>
              {% for fee in fees %}
                <tr>
                  <td>{{ t('{{ from }} to {{ till }}', { from: fee.from | pennies2pounds | numeral, till: fee.to | pennies2pounds | numeral } )}}</td>
                  <td>{{ fee.fee.amount | pennies2pounds | numeral }}</td>
                </tr>
              {% endfor %}
            </table>
          </div>
        </details>
        {% endif %}
      {% endif %}

      <h2 class="heading-medium">{{ t('How to complete and send your response') }}</h2>
      <ul class="list list-number">
        <li>

          {% if draft.response.type === ResponseType.FULL_ADMISSION %}
            {{ t('Open ' + externalLink('admission form N9A', asset_paths["pdf"] + '/OCON9A.pdf') + ' and complete using:') | safe }}
          {% endif %}

          {% if draft.response.type === ResponseType.PART_ADMISSION %}
            {{ t('Complete both ' + externalLink('admission form N9A', asset_paths["pdf"] + '/OCON9A.pdf')+ ' and '
               + externalLink('defence and counterclaim N9B', asset_paths["pdf"] + '/OCON9B.pdf') + ' using:') | safe }}
          {% endif %}

          {% if draft.response.type === ResponseType.DEFENCE %}
            {% if draft.rejectAllOfClaim.option === RejectAllOfClaimOption.COUNTER_CLAIM %}
              {{ t('Complete both ' + externalLink('defence and counterclaim form N9B', asset_paths["pdf"] + '/OCON9B.pdf') + ' using:',
              { ocon9B: [asset_paths["pdf"] + '/OCON9B.pdf']}) | safe }}
            {% elseif draft.howMuchPaidClaimant.option === HowMuchPaidClaimantOption.LESS_THAN_AMOUNT_CLAIMED %}
              {{ t('Complete both ' + externalLink('admission form N9A', asset_paths["pdf"] + '/OCON9A.pdf')+ ' and '
              + externalLink('defence and counterclaim N9B', asset_paths["pdf"] + '/OCON9B.pdf') + ' using:') | safe }}
            {% endif %}
          {% endif %}

          <ul class="list list-bullet">
              <li>{{ t('Claim No. {{ claimNumber }}', { claimNumber: claim.claimNumber }) }}</li>
              <li>{{ t('Claimant {{ claimantName }}', { claimantName: claim.claimData.claimant.name}) }}</li>
              <li>{{ t('Defendant {{ defendantName }}', { defendantName: claim.claimData.defendant.name}) }}</li>
          </ul>
        </li>
        <li>{{ t('Save the completed form to your device') }}</li>
        <li>
        {{ t('Email the forms to '
        +'<a href="mailto:{{ supportEmailAddress }}?Subject={{ claimNumber }}">{{ supportEmailAddress }}</a>"',
        { supportEmailAddress: supportEmailAddress , claimNumber: claim.claimNumber }) | safe }}
        </li>
      </ul>

      {{ supportWidget() }}
      {% include "includes/service_survey_link.njk" %}

    </div>

  </div>

{% endblock %}

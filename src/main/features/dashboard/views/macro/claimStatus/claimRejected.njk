{% from "externalLink.njk" import externalLink %}
{% from "internalLink.njk" import internalLink %}

{% macro claimRejectedAlreadyPaidForClaimantDashboard(claim) %}
  {{ t('{{ defendantName }} believes that they’ve paid the claim in full.',
    { defendantName: claim.claimData.defendant.name }) }}
{% endmacro %}

{% macro claimRejectedAlreadyPaidForClaimantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('The defendant’s response') }}</h2>
    <p>{{ t('{{ defendantName }} believes that they’ve paid the claim in full. '
        + 'Email {{ emailAddress }} if you want to proceed with the claim. '
        + 'You must do this before 4pm on {{ respondToResponseDeadline }}.',
        { defendantName: claim.claimData.defendant.name, emailAddress: supportEmailAddress,
          respondToResponseDeadline: claim.respondToResponseDeadline | date }) }}</p>
    <p>{{ _respond(claim, 'Respond') }}</p>
  </div>
{% endmacro %}

{% macro claimRejectedAlreadyPaidForDefendantDashboard(claim) %}
  {{ t('We’ve emailed {{ claimantName }} telling them when and how you said you paid the claim.',
    { claimantName: claim.claimData.claimant.name }) }}
{% endmacro %}

{% macro claimRejectedAlreadyPaidForDefendantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('Your response to the claim') }}</h2>
    <p>{{ t('We’ve emailed {{ claimantName }} telling them when and how you said you paid the claim.',
        { claimantName: claim.claimData.claimant.name }) }}</p>
    <p>{{ t('We’ll contact you to let you know how they respond. They can confirm you’ve paid and the claim is ' +
        'settled, or they can proceed with it.') }}</p>
    <p>{{ _downloadResponseLink(claim, 'Download your response') }}</p>
  </div>
{% endmacro %}

{% macro claimRejectedFreeMediationNOForClaimantDashboard(claim) %}
  {{ t('{{ defendantName }} has rejected your claim.',
    { defendantName: claim.claimData.defendant.name }) }}
{% endmacro %}

{% macro claimRejectedDefendantDefenceFreeMediationNOForClaimantDashboard(claim) %}
  {{ t('You’ve reject the defendant’s response.') }}
{% endmacro %}

{% macro claimRejectedDefendantDefenceFreeMediationNOForClaimantDetails(claim) %}
  {{ t('You’ve reject the defendant’s response.') }}
{% endmacro %}

{% macro claimRejectedFreeMediationNOForClaimantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('The defendant has rejected your claim') }}</h2>
    <p>{{ t('They said they dispute your claim.') }}</p>
    {{ _linkToDirectionsQuestionnairePage(claim.externalId) }}
    <p>{{ t('Your claim won’t proceed if you don’t complete and return the form before 4pm on {{ deadline }}.',
        { deadline: claim.directionsQuestionnaireDeadline | date }) }}</p>
    <p>{{ _downloadResponseLink(claim, 'Download their response') }}</p>
  </div>
{% endmacro %}

{% macro claimRejectedFreeMediationNOForDefendantDashboard() %}
  {{ t('You’ve rejected the claim. You need to tell us more about the claim.') }}
{% endmacro %}

{% macro claimRejectedFreeMediationNOForDefendantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('Your response to the claim') }}</h2>
    <p>{{ t('You’ve rejected the claim and said you don’t want to use mediation to solve it. You’ll have to go to a hearing.') }}</p>
    {{ _linkToDirectionsQuestionnairePage(claim.externalId) }}
    <p>{{ t('Your defence will be cancelled if you don’t complete and return the form before 4pm on {{ deadline }}.',
        { deadline: claim.directionsQuestionnaireDeadline | date }) }}</p>
    <p>{{ _downloadResponseLink(claim, 'Download your response') }}</p>
  </div>
{% endmacro %}

{% macro claimRejectedFreeMediationYESForClaimantDashboard(claim) %}
  {{ t('{{ defendantName }} has rejected the claim. They’ve suggested a mediation session to help resolve this dispute.',
    { defendantName: claim.claimData.defendant.name }) }}
{% endmacro %}

{% macro claimRejectedDefendantDefenceFreeMediationYESForClaimantDashboard(claim) %}
    {{ t('You’ve rejected the defendant’s response.') }}

    {% if claim.claimantResponse.freeMediation === FreeMediationOption.YES %}
      <p>{{ t('You’ve both agreed to try mediation.') }}
    {% endif %}
{% endmacro %}

{% macro claimRejectedDefendantDefenceFreeMediationYESForClaimantDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('You’ve rejected the defendant’s response.') }}</h2>

    {% if claim.claimantResponse.freeMediation === FreeMediationOption.YES %}
    <p>{{ t('You’ve both agreed to try mediation. The Small Claims Mediation Service will contact you to arrange an appointment.') }}</p>
        {{ externalLink('Find out how mediation works', 'https://www.gov.uk/government/publications/small-claims-mediation-service-ex730') }}
    {% endif %}

    <p>{{ _downloadResponseLink(claim, 'Download your response') }}</p>

  </div>
{% endmacro %}

{% macro claimRejectedFreeMediationYESForClaimantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('Decide whether to proceed') }}</h2>
    <p>{{ t('{{ defendantName }} has rejected your claim.', { defendantName: claim.claimData.defendant.name }) }}</p>
    <p>{{ t('You need to decide whether to proceed with the claim. You need to respond before 4pm on {{ respondToMediationDeadline }}. Your claim won’t continue if you don’t respond by then.',
        { respondToMediationDeadline: claim.respondToMediationDeadline | date }) }}</p>
    <p>{{ internalLink(t('View and respond'), ClaimantResponsePaths.taskListPage.evaluateUri({ externalId: claim.externalId }), 'button button-primary') }}</p>
  </div>
{% endmacro %}

{% macro claimRejectedFreeMediationYESForDefendantDashboard() %}
  {{ t('You’ve rejected the claim and suggested mediation. We’ll ask the claimant if they agree to take part in mediation.') }}
{% endmacro %}

{% macro claimRejectedFreeMediationYESForDefendantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('Your response to the claim') }}</h2>
    <p>{{ t('You have rejected the claim. You’ve suggested mediation.') }}</p>
    <p>{{ t('We’ll ask {{ claimantName }} if they agree to take part in mediation.',
        { claimantName: claim.claimData.claimant.name }) }}</p>
    <p>{{ t('If they say yes, we’ll arrange a date for mediation. If they say no we’ll send you a directions questionnaire - '
        + 'this is a form you complete to tell us more about the claim.') }}</p>
    <p>{{ _downloadResponseLink(claim, 'Download your response') }}</p>
  </div>

{% endmacro %}

{% macro _downloadResponseLink(claim, text) %}
  {{ internalLink(t(text), ResponsePaths.receiptReceiver.evaluateUri({ externalId: claim.externalId })) }}
{% endmacro %}

{% macro _linkToDirectionsQuestionnairePage(externalId) %}
  <p>{{ t('You need to {{ completeDQ }} form to tell us more about the claim.',
        { completeDQ: internalLink(
          'complete a directions questionnaire',
          DashboardPaths.directionsQuestionnairePage.evaluateUri({ externalId: externalId }))
        }
      ) | safe
  }}</p>
{% endmacro %}

{% macro _respond(claim, text) %}
  <p>{{ internalLink(t(text), ClaimantResponsePaths.taskListPage.evaluateUri({ externalId: claim.externalId }), 'button button-secondary') }}</p>
{% endmacro %}

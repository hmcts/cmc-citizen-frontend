{% from "internalLink.njk" import internalLink %}
{% from "./utilityMacros.njk" import downloadResponseLink, admissionByCCJCommonInfoClaimDetails %}

{% macro settlementAgreementSignedByClaimantDefendantDashboard(claim) %}
  {{ t('{{ claimantName }} asked you to sign a settlement agreement', { claimantName: claim.claimData.claimant.name }) }}
{% endmacro %}

{% macro CCJAfterBreakingSettlementAgreementClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('{{ claimantName }} requested a County Court Judgment (CCJ) against you', { claimantName: claim.claimData.claimant.name }) }}</h2>
    <p>{{ t('They requested the judgment because you didn’t pay on time or didn’t pay the correct amount.') }}</p>
    <p>{{ internalLink('View the repayment plan', CCJPaths.repaymentPlanSummaryPage.evaluateUri({ externalId: claim.externalId, madeBy: MadeBy.DEFENDANT.value })) }}</p>

    {{ admissionByCCJCommonInfoClaimDetails(claim) }}
  </div>
{% endmacro %}

{% macro pastPaymentDeadlineDefendantClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('{{ claimantName }} requested a County Court Judgment (CCJ) against you', { claimantName: claim.claimData.claimant.name }) }}</h2>
    {% if claim.response.responseType === domain.ResponseType.PART_ADMISSION and claim.claimantResponse.courtDetermination %}
      <p>{{ t('They accepted your offer to pay {{ partAdmitAmount }} but rejected your repayment plan.',
          { partAdmitAmount: claim.response.amount }) }}</p>
    {% endif %}
    {% if claim.response.paymentIntention.paymentOption === domain.PaymentOption.IMMEDIATELY %}
      <p>{{ t('{{ claimantName }} accepted your offer to pay {{ partAdmitAmount }} immediately.',
          { claimantName: claim.claimData.claimant.name, partAdmitAmount: claim.response.amount }) }}</p>
      <p>{{ t('Because you didn’t pay within 5 days, they requested the CCJ.') }}</p>
    {% elseif claim.response.paymentIntention.paymentOption === domain.PaymentOption.BY_SPECIFIED_DATE %}
      <p>{{ t('They’ve offered to pay by {{ paymentDate }}.', { paymentDate: claim.response.paymentIntention.paymentDate | date }) }}</p>
    {% elseif claim.response.paymentIntention.paymentOption === domain.PaymentOption.INSTALMENTS %}
      <p>{{ t('They’ve offered to pay in instalments.') }}</p>
    {% endif %}

    {% if claim.claimantResponse.courtDetermination.decisionType !== DecisionType.CLAIMANT %}
      <p>{{ t('They accepted a new repayment plan determined by the court, based on the financial details you provided.') }}</p>
    {% else %}
      <p>{{ t('They suggested a new repayment plan. The court believes you can afford the claimant’s plan, based on the financial details you provided.') }}</p>
    {% endif %}

    <p>{{ t('{{ claimantName }} accepted your offer to pay {{ partAdmitAmount }} but rejected your repayment plan.',
        { claimantName: claim.claimData.claimant.name, partAdmitAmount: claim.response.amount }) }}</p>
    {{ admissionByCCJCommonInfoClaimDetails(claim) }}
  </div>
{% endmacro %}

{% macro admissionByCCJAfterPayImmediatelyDeadlineClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('A County Court Judgment (CCJ) has been issued against you') }}</h2>
    {% if claim.response.responseType === domain.ResponseType.FULL_ADMISSION %}
      <p>{{ t('You agreed to pay the full {{ amount }} immediately.', { amount: claim.response.amount }) }}</p>
    {% elif claim.response.responseType === domain.ResponseType.PART_ADMISSION %}
      <p>{{ t('{{ claimantName }} accepted your offer to pay {{ partAdmitAmount }} immediately.',
          { claimantName: claim.claimData.claimant.name, partAdmitAmount: claim.response.amount }) }}</p>
    {% endif %}
    <p>{{ t('Because you didn’t pay within 5 days, they requested a CCJ against you.') }}</p>

    {{ admissionByCCJCommonInfoClaimDetails(claim) }}
  </div>
{% endmacro %}

{% macro CCJAfterDefendantDidNotSignSettlementAgreementClaimDetails(claim) %}
  <div class="status-block">
    <h2 class="heading-small">{{ t('A County Court Judgment (CCJ) has been issued against you') }}</h2>

    <p>{{ t('{{ claimantName }} accepted your repayment plan.', { claimantName: claim.claimData.claimant.name }) }}</p>
    <p>{{ t('They asked you to sign a settlement agreement. Because you didn’t sign it, they requested a CCJ against you.') }}</p>
    <p>{{ internalLink('View the repayment plan', CCJPaths.repaymentPlanSummaryPage.evaluateUri({ externalId: claim.externalId, madeBy: MadeBy.DEFENDANT.value })) }}</p>

    {{ admissionByCCJCommonInfoClaimDetails(claim) }}
  </div>
{% endmacro %}

{% from "externalLink.njk" import externalLink %}

{% macro claimPartAdmittedToOweForDefendantClaimDetails(claim) %}
  <h2 class="heading-small">{{ t('Your response to the claim') }}</h2>

  <p>
    {% if claim.response.paymentIntention.paymentOption === domain.PaymentOption.IMMEDIATELY %}
      {{ t('You’ve said you owe {{ amount }} and offered to pay {{ claimantName }} immediately.',
        { amount: claim.response.amount | numeral, claimantName: claim.claimData.claimant.name }) }}
    {% elseif claim.response.paymentIntention.paymentOption === domain.PaymentOption.BY_SPECIFIED_DATE %}
      {{ t('You’ve said you owe {{ amount }} and offered to pay {{ claimantName }} on {{ paymentDate }}.',
        { amount: claim.response.amount | numeral, claimantName: claim.claimData.claimant.name, paymentDate: claim.response.paymentIntention.paymentDate | date }) }}
    {% elseif  claim.response.paymentIntention.paymentOption === domain.PaymentOption.INSTALMENTS %}
      {% set repaymentPlan = claim.response.paymentIntention.repaymentPlan %}
      {% set installmentAmount = repaymentPlan.instalmentAmount | numeral %}
      {% set paymentSchedule = t(repaymentPlan.paymentSchedule | renderPaymentSchedule) %}
      {{ t('You’ve said you owe {{ amount }} and offered to pay {{ claimantName }} {{ installmentAmount }} {{ paymentSchedule }} starting {{ paymentDate }}.',
        { amount: claim.response.amount | numeral, claimantName: claim.claimData.claimant.name,
          installmentAmount: installmentAmount, paymentSchedule: paymentSchedule, paymentDate: repaymentPlan.firstPaymentDate | date }) }}
    {% endif %}
  </p>
  <p>
    {{ t('We’ll contact you when they respond.') }}
  </p>
  <p>
    {{ _downloadResponseLink(claim) }}
  </p>
{% endmacro %}

{% macro claimPartAdmittedToOweForClaimantClaimDetails(claim) %}
    {#NEEDS TO BE DELETED - After admissions feature toggle is removed#}
  <h2 class="heading-small">{{ t('The defendant’s response') }}</h2>
  <p>{{ t('{{ defendantName }} admits they owe you {{ amount }} - they said they don’t owe the full amount you claimed.',
      { defendantName: claim.claimData.defendant.name, amount: claim.response.amount | numeral }) }} </p>
  <p>
    {{ t('You need to accept or reject the defendant’s admission of {{ amount }}.',
      { amount: claim.response.amount | numeral }) }}
  </p>
  {{ _respond(claim, 'View and respond to offer') }}


{% endmacro %}

{% macro claimPartAdmittedToOweForDefendantDashboard(claim) %}
  {#NEEDS TO BE DELETED - After admissions feature toggle is removed#}
  {{ t('You’ve admitted part of the claim.') }}
{% endmacro %}


{% macro _downloadResponseLink(claim) %}
  <a href="{{ ResponsePaths.receiptReceiver.evaluateUri({ externalId: claim.externalId }) }}">{{ t('Download your response') }}</a>{{ t(' (PDF)') }}
{% endmacro %}

{% macro _respond(claim, text) %}
  <p><a href='{{ ClaimantResponsePaths.taskListPage.evaluateUri({ externalId: claim.externalId }) }}' class="button button-secondary">{{ t(text) }}</a></p>
{% endmacro %}

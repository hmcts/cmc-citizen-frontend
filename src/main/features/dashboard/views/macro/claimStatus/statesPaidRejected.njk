{% from "internalLink.njk" import internalLink %}
{% from "./utilityMacros.njk" import downloadResponseLink %}

{% macro statesPaidRejectedClaimantDashboard() %}
  {{ t('You’ve rejected the defendant’s admission.') }}
{% endmacro %}

{% macro statesPaidRejectedClaimantClaimDetails(claim) %}
  {% if claim.claimantResponse.freeMediation and claim.claimantResponse.freeMediation === YesNoOption.YES.option %}
    {{ statesPaidRejectedMediationYESClaimantClaimDetails(claim) }}
  {% else %}
    {{ statesPaidRejectedMediationNOClaimantClaimDetails(claim) }}
  {% endif %}
{% endmacro %}

{% macro statesPaidRejectedMediationYESClaimantClaimDetails(claim) %}
  {% if claim.response.responseType === 'PART_ADMISSION' %}
    {% set amount = claim.response.amount %}
  {% else %}
    {% set amount = claim.response.paymentDeclaration.paidAmount  %}
  {% endif %}
  <h2 class="heading-small">{{ t('We’ll contact you with a mediation appointment') }}</h2>
  <p>{{ t('You rejected the defendant’s admission of {{ amount }}.', { amount: amount | numeral }) }}</p>
{% endmacro %}

{% macro statesPaidRejectedMediationNOClaimantClaimDetails(claim) %}
  <h2 class="heading-small">{{ t('Wait for the court to review the case') }}</h2>
  <p>{{ t('You’ve rejected {{ defendantName }}’s response and said you want to take the case to court.',
      { defendantName: claim.claimData.defendant.name }) }}</p>
  <p>{{ t('The court will review the case. We’ll email you if we set a hearing date to tell you how to prepare.') }}</p>
{% endmacro %}

{% macro statesPaidRejectedDefendantDashboard(claim) %}
  {% if claim.response.responseType === 'PART_ADMISSION' %}
    {% set amount = claim.response.amount %}
  {% else %}
    {% set amount = claim.response.paymentDeclaration.paidAmount  %}
  {% endif %}
  {{ t('{{ claimantName }} rejected your admission of {{ amount }}', {
    claimantName: claim.claimData.claimant.name,
    amount: amount | numeral
  }) }}
{% endmacro %}

{% macro statesPaidRejectedDefendantClaimDetails(claim) %}
  {% if claim.response.responseType === 'PART_ADMISSION' %}
    {% set amount = claim.response.amount %}
  {% else %}
    {% set amount = claim.response.paymentDeclaration.paidAmount  %}
  {% endif %}
  {% set mediation = claim.claimantResponse.freeMediation and claim.claimantResponse.freeMediation === YesNoOption.YES.option %}

  {% if mediation %}
    <h2 class="heading-small">{{ t('We’ll contact you with a mediation appointment') }}</h2>
  {% else %}
    <h2 class="heading-small">{{ t('Wait for the court to review the case') }}</h2>
  {% endif %}

  <p>{{ t('{{ claimantName }} rejected your admission of {{ amount }}.', {
      claimantName: claim.claimData.claimant.name,
      amount: amount | numeral
    }) }}</p>
  <p>{{ t('They said you didn’t pay them {{ amount }}.', { amount: amount | numeral }) }}</p>

  {% if mediation %}
    {{ statesPaidRejectedMediationYESDefendantClaimDetails(claim) }}
  {% else %}
    {{ statesPaidRejectedMediationNODefendantClaimDetails(claim) }}
  {% endif %}
{% endmacro %}

{% macro statesPaidRejectedMediationYESDefendantClaimDetails(claim) %}
  <p>{{ t('They’ve agreed to try mediation. We’ll contact you with details of your appointment.') }}</p>
{% endmacro %}

{% macro statesPaidRejectedMediationNODefendantClaimDetails(claim) %}
  <p>{{ t('You might have to go to a court hearing. We’ll contact you if we set a hearing date to tell you how to prepare.') }}</p>
{% endmacro %}

{% macro _linkToDirectionsQuestionnairePage(externalId) %}
  <p>{{ t('You need to {{ completeDQ }} form to tell us more about the claim.',
      { completeDQ: internalLink(
        'complete a directions questionnaire',
        DashboardPaths.directionsQuestionnairePage.evaluateUri({ externalId: externalId }))
      }
    ) | safe
    }}</p>
{% endmacro %}

{% macro _downloadResponseLink(claim, text) %}
  <a href="{{ ResponsePaths.receiptReceiver.evaluateUri({ externalId: claim.externalId }) }}">{{ t(text) }}</a>
{% endmacro %}

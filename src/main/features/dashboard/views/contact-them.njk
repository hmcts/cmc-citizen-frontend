{% extends "layout.njk" %}
{% from "./macro/caseHistory.njk" import caseHistoryForClaimantClaimDetails %}
{% from "../../claim/views/macro/about-claim-widget.njk" import aboutClaimWidget %}

{% set headingVisible = false %}

{% if user.id === claim.claimantId %}
  {% set otherParty = 'defendant' %}
  {% set otherPartyName = claim.claimData.defendant.name %}
  {% set phone = claim.response.defendant.mobilePhone %}
  {% set email = claim.claimData.defendant.email %}
  {% set contactPerson = claim.response.defendant.name %}
  {% set address = claim.response.defendant.address if claim.response.defendant.address else claim.claimData.defendant.address   %}
  {% set correspondenceAddress = claim.response.defendant.correspondenceAddress if claim.response.defendant.correspondenceAddress else claim.claimData.defendant.correspondenceAddress %}
  {% set contactPerson = claim.response.defendant.contactPerson %}

{% elif user.id === claim.defendantId %}
  {% set otherParty = 'claimant' %}
  {% set otherPartyName = claim.claimData.claimant.name %}
  {% set phone = claim.claimData.claimant.mobilePhone %}
  {% set email = claim.claimantEmail %}
  {% set address = claim.claimData.claimant.address %}
  {% set correspondenceAddress = claim.claimData.claimant.correspondenceAddress %}
  {% set contactPerson = claim.claimData.claimant.contactPerson %}

{% endif %}

{% set heading = 'Contact ' + t(otherParty) %}

{% block content %}
  <div class="grid-row">
    <div class="column-two-thirds">
      <h1 class="heading-large">
        <span class="heading-secondary">{{ t(otherParty) | capitalize }}</span>
        {{ otherPartyName }}
      </h1>
      <div class="notice">
        {% if address %}
          <h2 class="heading-medium">{{ t('Address') }}</h2>
          {% if address.line1 %}
            {{ address.line1 }}
          {% endif %}

          {% if address.line2 %}
            <br>
            {{ address.line2 }}
          {% endif %}

          {% if address.line3 %}
            <br>
            {{ address.line3 }}
          {% endif %}

          {% if address.city %}
            <br>
            {{ address.city }}
          {% endif %}

          {% if address.postcode %}
            <br>
            {{ address.postcode }}
          {% endif %}

        {% endif %}
      </div>


      {% if correspondenceAddress %}
        <div class="notice">
          <h2 class="heading-medium">{{ t('Correspondence address') }}</h2>
          {% if correspondenceAddress.line1 %}
            {{ correspondenceAddress.line1 }}
          {% endif %}

          {% if correspondenceAddress.line2 %}
            <br>
            {{ correspondenceAddress.line2 }}
          {% endif %}

          {% if correspondenceAddress.line3 %}
            <br>
            {{ correspondenceAddress.line3 }}
          {% endif %}

          {% if correspondenceAddress.city %}
            <br>
            {{ correspondenceAddress.city }}
          {% endif %}

          {% if correspondenceAddress.postcode %}
            <br>
            {{ correspondenceAddress.postcode }}
          {% endif %}
        </div>
      {% endif %}

      <div>
        {% if phone %}
          <span class="block">{{ t('Phone: ' ) + phone }}</span>
        {% endif %}

        {% if email %}
          <span class="block">{{ t('Email: <a href="mailto:{{ email }}">{{ email }}</a>', { email: email }) | safe }}</span>
        {% endif %}

        {% if contactPerson %}
          <span class="block">{{ t('Contact person: ' + contactPerson) }}</span>
        {% endif %}
      </div>
    </div>


    {% if claim %}
      <div class="column-one-third">
        {{ aboutClaimWidget(user, claim) }}
      </div>
    {% endif %}
  </div>
{% endblock %}

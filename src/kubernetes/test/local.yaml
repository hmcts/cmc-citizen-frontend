
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      app: frontend
  template:
    metadata:
      labels:
        app: frontend
    spec:
      containers:
      - image: cmc-frontend
        name: frontend
        env:
        - name: REFORM_TEAM
          value: 'cmc'
        - name: REFORM_SERVICE_NAME
          value: 'citizen-frontend'
        - name: NODE_ENV
          value: 'dev'
        - name: IDAM_API_URL
          value: 'https://localhost:docker-compose-exposed'
        - name: IDAM_AUTHENTICATION_WEB_URL
          value: 'https://localhost:docker-compose-exposed'
        - name: IDAM_S2S_AUTH
          value: 'http://localhost:docker-compose-exposed'
        - name: PAY_URL
          value: 'http://localhost:docker-compose-exposed'
        - name: CLAIM_STORE_URL
          value: 'http://localhost:docker-compose-exposed'
        - name: FEES_URL
          value: 'http://localhost:docker-compose-exposed'
        - name: DRAFT_STORE_URL
          value: 'http://localhost:docker-compose-exposed'
        - name: FEATURE_TOGGLES_API_URL
          value: 'http://localhost:docker-compose-exposed'
        - name: POSTCODE_LOOKUP_API_KEY
          value: '123456'
        - name: APPINSIGHTS_INSTRUMENTATIONKEY
          value: 'fakekey'
        - name: UV_THREADPOOL_SIZE
          value: '64'
        - name: APPLICATION_CONTEXT
          value: 'cmc-citizen-frontend-pr-938'
        resources:
          requests:
            memory: "128Mi"
            cpu: "0.1"
          limits:
            memory: "512Mi"
            cpu: "1"
        ports:
        - containerPort: 3000
          name: http
        imagePullPolicy: Never
---
apiVersion: v1
kind: Service
metadata:
  name: frontend
spec:
  type: NodePort
  ports:
  - port: 3000
    targetPort: 3000
  selector:
    app: frontend
